<!DOCTYPE html>
<html>
<head>
    <title>Stork Chase Adventure</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #222;
            font-family: 'Courier New', monospace;
        }
        #game-container {
            position: relative;
            width: 800px;
            height: 400px;
            margin: 20px auto;
            background-color: #000;
            overflow: hidden;
        }
        #game-canvas {
            background-color: #87CEEB;
        }
        #ui {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 20px;
        }
        #instructions {
            position: absolute;
            width: 100%;
            text-align: center;
            color: white;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
            background-color: rgba(0,0,0,0.7);
            padding: 20px;
        }
        #level-end {
            display: none;
            position: absolute;
            width: 100%;
            text-align: center;
            color: white;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
            background-color: rgba(0,0,0,0.7);
            padding: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 18px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas" width="800" height="400"></canvas>
        <div id="ui">
            <div id="hearts">❤️❤️❤️</div>
            <div>Bunnies: <span id="bunny-count">0</span></div>
            <div>Carrots: <span id="carrot-count">0</span></div>
            <div>Time: <span id="time">0</span>s</div>
        </div>
        <div id="instructions">
            <h2>Stork Chase Adventure</h2>
            <p>Use WASD to move</p>
            <p>Steal the bunny from the yard!</p>
            <p>Press SPACE to start</p>
        </div>
        <div id="level-end">
            <h2>Level Complete!</h2>
            <p>Time: <span id="end-time">0</span>s</p>
            <p>Bunnies collected: <span id="end-bunnies">0</span></p>
            <p>Carrots collected: <span id="end-carrots">0</span></p>
            <button id="next-level">Next Level</button>
            <button id="restart-level">Restart Level</button>
        </div>
    </div>
    <audio id="bg-music" loop>
        <source src="https://www.youtube.com/embed/Pn61zKFkf2A" type="audio/mpeg">
    </audio>
    <script>
        // Game variables
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const ui = document.getElementById('ui');
        const hearts = document.getElementById('hearts');
        const bunnyCount = document.getElementById('bunny-count');
        const carrotCount = document.getElementById('carrot-count');
        const timeDisplay = document.getElementById('time');
        const instructions = document.getElementById('instructions');
        const levelEnd = document.getElementById('level-end');
        const endTime = document.getElementById('end-time');
        const endBunnies = document.getElementById('end-bunnies');
        const endCarrots = document.getElementById('end-carrots');
        const nextLevelBtn = document.getElementById('next-level');
        const restartLevelBtn = document.getElementById('restart-level');
        const bgMusic = document.getElementById('bg-music');

        // Game state
        let gameState = 'intro'; // intro, running, levelEnd
        let level = 1;
        let health = 3;
        let bunniesCollected = 0;
        let carrotsCollected = 0;
        let startTime = 0;
        let currentTime = 0;

        // Player
        const player = {
            x: 100,
            y: 300,
            width: 40,
            height: 60,
            speed: 2,
            velocityY: 0,
            jumping: false,
            direction: 'right',
            carryingBunny: false
        };

        // Stork
        const stork = {
            x: 700,
            y: 300,
            width: 60,
            height: 80,
            speed: 1,
            state: 'reading', // reading, chasing, flying, pooping
            stateTimer: 0,
            poops: []
        };

        // Game objects
        let bunnies = [];
        let carrots = [];
        let obstacles = [];
        let powerups = [];
        let holes = [];
        let trees = [];

        // Controls
        const keys = {
            w: false,
            a: false,
            s: false,
            d: false
        };

        // Event listeners
        document.addEventListener('keydown', (e) => {
            if (e.key.toLowerCase() === 'w') keys.w = true;
            if (e.key.toLowerCase() === 'a') keys.a = true;
            if (e.key.toLowerCase() === 's') keys.s = true;
            if (e.key.toLowerCase() === 'd') keys.d = true;
            if (e.key === ' ' && gameState === 'intro') startGame();
        });

        document.addEventListener('keyup', (e) => {
            if (e.key.toLowerCase() === 'w') keys.w = false;
            if (e.key.toLowerCase() === 'a') keys.a = false;
            if (e.key.toLowerCase() === 's') keys.s = false;
            if (e.key.toLowerCase() === 'd') keys.d = false;
        });

        nextLevelBtn.addEventListener('click', nextLevel);
        restartLevelBtn.addEventListener('click', restartLevel);

        // Initialize game
        function initLevel() {
            // Clear previous level objects
            bunnies = [];
            carrots = [];
            obstacles = [];
            powerups = [];
            holes = [];
            trees = [];
            stork.poops = [];
            
            // Set up level based on level number
            if (level === 1) {
                // Intro level - backyard scene
                gameState = 'intro';
                player.x = 100;
                player.y = 300;
                player.carryingBunny = false;
                stork.x = 600;
                stork.y = 300;
                stork.state = 'reading';
                stork.speed = 0;
                
                // Add a bunny to kidnap
                bunnies.push({ x: 500, y: 320, width: 30, height: 30, color: 'brown' });
            } else {
                // Running levels
                gameState = 'running';
                player.x = 50;
                player.y = 300;
                player.carryingBunny = false;
                player.speed = 2 + (level * 0.5);
                stork.x = -100;
                stork.y = 300;
                stork.state = 'chasing';
                stork.speed = 1 + (level * 0.3);
                stork.stateTimer = 0;
                
                // Add level elements
                for (let i = 0; i < 5 + (level * 2); i++) {
                    bunnies.push({
                        x: 200 + Math.random() * 2000,
                        y: 300,
                        width: 30,
                        height: 30,
                        color: Math.random() > 0.5 ? 'brown' : 'grey'
                    });
                    
                    carrots.push({
                        x: 300 + Math.random() * 2000,
                        y: 310,
                        width: 20,
                        height: 20
                    });
                    
                    if (i % 2 === 0) {
                        holes.push({
                            x: 400 + Math.random() * 2000,
                            y: 330,
                            width: 60,
                            height: 40
                        });
                    }
                    
                    if (i % 3 === 0) {
                        trees.push({
                            x: 500 + Math.random() * 2000,
                            y: 280,
                            width: 40,
                            height: 120,
                            trunkHeight: 40
                        });
                    }
                }
                
                // Add powerups starting from level 3
                if (level >= 3) {
                    for (let i = 0; i < 2 + (level - 2); i++) {
                        powerups.push({
                            x: 600 + Math.random() * 2000,
                            y: 310,
                            width: 30,
                            height: 30,
                            type: Math.random() > 0.5 ? 'shirt' : 'bottle'
                        });
                    }
                }
            }
            
            startTime = Date.now();
            currentTime = 0;
        }

        function startGame() {
            gameState = 'running';
            instructions.style.display = 'none';
            bgMusic.play();
            startTime = Date.now();
            requestAnimationFrame(gameLoop);
        }

        function nextLevel() {
            level++;
            levelEnd.style.display = 'none';
            initLevel();
            requestAnimationFrame(gameLoop);
        }

        function restartLevel() {
            levelEnd.style.display = 'none';
            initLevel();
            requestAnimationFrame(gameLoop);
        }

        function gameLoop() {
            update();
            render();
            
            if (gameState !== 'levelEnd') {
                requestAnimationFrame(gameLoop);
            }
        }

        function update() {
            // Update time
            currentTime = Math.floor((Date.now() - startTime) / 1000);
            timeDisplay.textContent = currentTime;
            
            // Player movement
            if (keys.a) {
                player.x -= player.speed;
                player.direction = 'left';
            }
            if (keys.d) {
                player.x += player.speed;
                player.direction = 'right';
            }
            
            // Jumping
            if (keys.w && !player.jumping) {
                player.velocityY = -12;
                player.jumping = true;
            }
            
            // Apply gravity
            player.velocityY += 0.8;
            player.y += player.velocityY;
            
            // Ground collision
            if (player.y > 300) {
                player.y = 300;
                player.velocityY = 0;
                player.jumping = false;
            }
            
            // Update stork behavior based on game state
            if (gameState === 'intro') {
                // Intro scene - stork reads newspaper
                if (player.carryingBunny) {
                    // Player has bunny - stork notices and starts chasing
                    stork.state = 'chasing';
                    stork.speed = 2;
                }
            } else {
                // Running levels
                stork.stateTimer += 1/60; // Assuming 60fps
                
                if (stork.state === 'chasing') {
                    stork.x += stork.speed;
                    
                    if (stork.stateTimer >= 8) {
                        stork.state = 'flying';
                        stork.stateTimer = 0;
                        stork.y = 150; // Fly up
                    }
                } else if (stork.state === 'flying') {
                    stork.x += stork.speed * 1.5;
                    
                    if (stork.stateTimer >= 1) {
                        stork.state = 'pooping';
                        stork.stateTimer = 0;
                        // Create poop
                        stork.poops.push({
                            x: stork.x,
                            y: stork.y + 40,
                            width: 20,
                            height: 20,
                            velocityY: 0
                        });
                    }
                } else if (stork.state === 'pooping') {
                    stork.x += stork.speed * 1.5;
                    
                    // Update poops
                    for (let i = 0; i < stork.poops.length; i++) {
                        stork.poops[i].velocityY += 0.5;
                        stork.poops[i].y += stork.poops[i].velocityY;
                        
                        // Remove poops that hit the ground
                        if (stork.poops[i].y > 320) {
                            stork.poops.splice(i, 1);
                            i--;
                        }
                    }
                    
                    if (stork.stateTimer >= 3) {
                        stork.state = 'chasing';
                        stork.stateTimer = 0;
                        stork.y = 300; // Land
                    }
                }
            }
            
            // Check collisions with bunnies
            for (let i = 0; i < bunnies.length; i++) {
                if (checkCollision(player, bunnies[i])) {
                    if (gameState === 'intro') {
                        player.carryingBunny = true;
                        bunnies.splice(i, 1);
                        // Show "RUN!" message
                        instructions.innerHTML = '<h2>RUN!</h2><p>The stork is chasing you!</p>';
                    } else {
                        bunniesCollected++;
                        bunnyCount.textContent = bunniesCollected;
                        bunnies.splice(i, 1);
                        i--;
                    }
                }
            }
            
            // Check collisions with carrots
            for (let i = 0; i < carrots.length; i++) {
                if (checkCollision(player, carrots[i])) {
                    carrotsCollected++;
                    carrotCount.textContent = carrotsCollected;
                    carrots.splice(i, 1);
                    i--;
                }
            }
            
            // Check collisions with powerups
            for (let i = 0; i < powerups.length; i++) {
                if (checkCollision(player, powerups[i])) {
                    // Apply speed boost
                    player.speed += 1;
                    setTimeout(() => {
                        player.speed -= 1;
                    }, 5000);
                    powerups.splice(i, 1);
                    i--;
                }
            }
            
            // Check collisions with poops
            for (let i = 0; i < stork.poops.length; i++) {
                if (checkCollision(player, stork.poops[i])) {
                    health--;
                    updateHearts();
                    stork.poops.splice(i, 1);
                    i--;
                    
                    if (health <= 0) {
                        gameOver();
                    }
                }
            }
            
            // Check collisions with holes
            for (let i = 0; i < holes.length; i++) {
                if (checkCollision(player, holes[i]) && player.y + player.height > holes[i].y) {
                    health--;
                    updateHearts();
                    // Bounce player out of hole
                    player.y = holes[i].y - player.height;
                    player.velocityY = -5;
                    
                    if (health <= 0) {
                        gameOver();
                    }
                }
            }
            
            // Check collisions with trees (need to duck)
            for (let i = 0; i < trees.length; i++) {
                if (checkCollision(player, trees[i]) && !keys.s) {
                    health--;
                    updateHearts();
                    
                    if (health <= 0) {
                        gameOver();
                    }
                }
            }
            
            // Check level completion (for running levels)
            if (gameState === 'running' && bunnies.length === 0 && carrots.length === 0) {
                levelComplete();
            }
        }

        function render() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            drawBackground();
            
            // Draw game objects based on level
            if (gameState === 'intro') {
                // Draw backyard scene
                drawBackyard();
                
                // Draw stork reading newspaper
                drawStork(stork.x, stork.y, 'reading');
                
                // Draw bunny
                if (bunnies.length > 0) {
                    drawBunny(bunnies[0].x, bunnies[0].y, bunnies[0].color);
                }
            } else {
                // Draw running level
                
                // Draw holes
                for (const hole of holes) {
                    drawHole(hole.x, hole.y, hole.width, hole.height);
                }
                
                // Draw trees
                for (const tree of trees) {
                    drawTree(tree.x, tree.y, tree.width, tree.height, tree.trunkHeight);
                }
                
                // Draw bunnies
                for (const bunny of bunnies) {
                    drawBunny(bunny.x, bunny.y, bunny.color);
                }
                
                // Draw carrots
                for (const carrot of carrots) {
                    drawCarrot(carrot.x, carrot.y, carrot.width, carrot.height);
                }
                
                // Draw powerups
                for (const powerup of powerups) {
                    drawPowerup(powerup.x, powerup.y, powerup.type);
                }
                
                // Draw stork based on state
                if (stork.state === 'chasing') {
                    drawStork(stork.x, stork.y, 'running');
                } else if (stork.state === 'flying' || stork.state === 'pooping') {
                    drawStork(stork.x, stork.y, 'flying');
                }
                
                // Draw poops
                for (const poop of stork.poops) {
                    drawPoop(poop.x, poop.y, poop.width, poop.height);
                }
            }
            
            // Draw player
            drawPlayer(player.x, player.y, player.direction, player.jumping, keys.s);
            
            // If player is carrying bunny in intro, draw bunny in arms
            if (gameState === 'intro' && player.carryingBunny) {
                drawBunny(player.x + (player.direction === 'right' ? 20 : -10), player.y - 10, 'brown');
            }
        }

        // Drawing functions (replace with actual sprite rendering)
        function drawBackground() {
            // Simple gradient background for forest
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB'); // Sky blue
            gradient.addColorStop(0.7, '#228B22'); // Forest green
            gradient.addColorStop(1, '#8B4513'); // Ground brown
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw some simple trees in background
            ctx.fillStyle = '#013220'; // Dark green
            for (let i = 0; i < 10; i++) {
                const x = (i * 150) % (canvas.width + 300) - 150;
                ctx.beginPath();
                ctx.moveTo(x + 30, 300);
                ctx.lineTo(x, 150);
                ctx.lineTo(x + 60, 150);
                ctx.closePath();
                ctx.fill();
                
                // Trunk
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(x + 25, 300, 10, 30);
                ctx.fillStyle = '#013220';
            }
        }

        function drawBackyard() {
            // Simple yard with fence
            ctx.fillStyle = '#90EE90'; // Light green grass
            ctx.fillRect(0, 300, canvas.width, 100);
            
            // Fence
            ctx.fillStyle = '#8B4513';
            for (let i = 0; i < canvas.width; i += 30) {
                ctx.fillRect(i, 280, 5, 20);
            }
            
            // House in background
            ctx.fillStyle = '#FF6347'; // Tomato color
            ctx.fillRect(400, 200, 150, 100);
            
            // Roof
            ctx.fillStyle = '#8B0000';
            ctx.beginPath();
            ctx.moveTo(390, 200);
            ctx.lineTo(475, 150);
            ctx.lineTo(560, 200);
            ctx.closePath();
            ctx.fill();
        }

        function drawPlayer(x, y, direction, jumping, ducking) {
            ctx.save();
            if (direction === 'left') {
                ctx.translate(x + 40, 0);
                ctx.scale(-1, 1);
                x = 0;
            }
            
            // Body
            ctx.fillStyle = '#FF69B4'; // Pink
            const height = ducking ? 40 : 60;
            ctx.fillRect(x, y - height, 40, height);
            
            // Head
            ctx.fillStyle = '#FFD700'; // Gold (hair)
            ctx.beginPath();
            ctx.arc(x + 20, y - height - 15, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Face
            ctx.fillStyle = '#FFE4B5'; // Moccasin (skin)
            ctx.beginPath();
            ctx.arc(x + 20, y - height - 15, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Eyes
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x + 15, y - height - 20, 3, 0, Math.PI * 2);
            ctx.arc(x + 25, y - height - 20, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Mouth
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(x + 20, y - height - 10, 5, 0, Math.PI);
            ctx.stroke();
            
            ctx.restore();
        }

        function drawStork(x, y, state) {
            ctx.save();
            
            if (state === 'reading') {
                // Body
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.ellipse(x, y, 30, 20, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Head
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.arc(x + 30, y - 20, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // Beak
                ctx.fillStyle = '#FFA500';
                ctx.beginPath();
                ctx.moveTo(x + 45, y - 20);
                ctx.lineTo(x + 60, y - 15);
                ctx.lineTo(x + 45, y - 10);
                ctx.closePath();
                ctx.fill();
                
                // Eyes
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(x + 35, y - 25, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Newspaper
                ctx.fillStyle = '#FFF';
                ctx.fillRect(x - 10, y - 40, 40, 30);
                ctx.strokeStyle = '#000';
                ctx.strokeRect(x - 10, y - 40, 40, 30);
                
                // Newspaper text
                ctx.fillStyle = '#000';
                ctx.font = '8px Arial';
                ctx.fillText('NEWS', x, y - 25);
            } else if (state === 'running') {
                // Running animation
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.ellipse(x, y, 30, 20, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Legs
                ctx.strokeStyle = '#FFA500';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(x - 10, y + 20);
                ctx.lineTo(x - 15, y + 40);
                ctx.moveTo(x + 10, y + 20);
                ctx.lineTo(x + 15, y + 40);
                ctx.stroke();
                
                // Head
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.arc(x + 30, y - 10, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // Beak
                ctx.fillStyle = '#FFA500';
                ctx.beginPath();
                ctx.moveTo(x + 45, y - 10);
                ctx.lineTo(x + 60, y - 5);
                ctx.lineTo(x + 45, y);
                ctx.closePath();
                ctx.fill();
                
                // Angry eyes
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.moveTo(x + 25, y - 15);
                ctx.lineTo(x + 30, y - 12);
                ctx.lineTo(x + 25, y - 9);
                ctx.fill();
                
                ctx.beginPath();
                ctx.moveTo(x + 35, y - 15);
                ctx.lineTo(x + 40, y - 12);
                ctx.lineTo(x + 35, y - 9);
                ctx.fill();
            } else if (state === 'flying') {
                // Flying animation
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.ellipse(x, y, 30, 15, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Wings
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.ellipse(x - 20, y, 40, 15, Math.PI/4, 0, Math.PI * 2);
                ctx.ellipse(x + 20, y, 40, 15, -Math.PI/4, 0, Math.PI * 2);
                ctx.fill();
                
                // Head
                ctx.fillStyle = '#FFF';
                ctx.beginPath();
                ctx.arc(x + 30, y - 10, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // Beak
                ctx.fillStyle = '#FFA500';
                ctx.beginPath();
                ctx.moveTo(x + 45, y - 10);
                ctx.lineTo(x + 60, y - 5);
                ctx.lineTo(x + 45, y);
                ctx.closePath();
                ctx.fill();
                
                // Angry eyes
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.moveTo(x + 25, y - 15);
                ctx.lineTo(x + 30, y - 12);
                ctx.lineTo(x + 25, y - 9);
                ctx.fill();
                
                ctx.beginPath();
                ctx.moveTo(x + 35, y - 15);
                ctx.lineTo(x + 40, y - 12);
                ctx.lineTo(x + 35, y - 9);
                ctx.fill();
            }
            
            ctx.restore();
        }

        function drawBunny(x, y, color) {
            ctx.fillStyle = color === 'brown' ? '#A0522D' : '#808080';
            
            // Body
            ctx.beginPath();
            ctx.ellipse(x, y, 15, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Head
            ctx.beginPath();
            ctx.arc(x, y - 15, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Ears
            ctx.beginPath();
            ctx.moveTo(x - 5, y - 25);
            ctx.lineTo(x - 8, y - 40);
            ctx.lineTo(x - 2, y - 25);
            ctx.closePath();
            ctx.fill();
            
            ctx.beginPath();
            ctx.moveTo(x + 5, y - 25);
            ctx.lineTo(x + 8, y - 40);
            ctx.lineTo(x + 2, y - 25);
            ctx.closePath();
            ctx.fill();
            
            // Eyes
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x - 5, y - 18, 2, 0, Math.PI * 2);
            ctx.arc(x + 5, y - 18, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // Nose
            ctx.beginPath();
            ctx.arc(x, y - 15, 1.5, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawCarrot(x, y, width, height) {
            ctx.fillStyle = '#FFA500'; // Orange
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + width, y - height/2);
            ctx.lineTo(x + width, y + height/2);
            ctx.closePath();
            ctx.fill();
            
            // Green top
            ctx.fillStyle = '#32CD32';
            ctx.beginPath();
            ctx.moveTo(x + width, y - height/2);
            ctx.lineTo(x + width + 5, y - height);
            ctx.lineTo(x + width + 10, y - height/3);
            ctx.lineTo(x + width, y + height/2);
            ctx.closePath();
            ctx.fill();
        }

        function drawPoop(x, y, width, height) {
            ctx.fillStyle = '#8B4513'; // Brown
            ctx.beginPath();
            ctx.ellipse(x, y, width/2, height/2, 0, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawHole(x, y, width, height) {
            ctx.fillStyle = '#000';
            ctx.fillRect(x, y, width, height);
        }

        function drawTree(x, y, width, height, trunkHeight) {
            // Trunk
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(x, y, width, trunkHeight);
            
            // Leaves
            ctx.fillStyle = '#013220';
            ctx.beginPath();
            ctx.moveTo(x - width, y);
            ctx.lineTo(x + width*2, y);
            ctx.lineTo(x + width/2, y - height);
            ctx.closePath();
            ctx.fill();
        }

        function drawPowerup(x, y, type) {
            ctx.fillStyle = '#9370DB'; // Purple
            
            if (type === 'shirt') {
                // T-shirt shape
                ctx.fillRect(x, y, 30, 20);
                ctx.fillRect(x - 5, y + 5, 10, 15);
                ctx.fillRect(x + 25, y + 5, 10, 15);
            } else if (type === 'bottle') {
                // Bottle shape
                ctx.fillRect(x + 10, y, 10, 30);
                ctx.beginPath();
                ctx.ellipse(x + 15, y, 10, 5, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Glitter effect
            ctx.fillStyle = '#FFF';
            for (let i = 0; i < 3; i++) {
                ctx.beginPath();
                ctx.arc(x + 5 + Math.random() * 20, y + 5 + Math.random() * 20, 1 + Math.random() * 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function checkCollision(obj1, obj2) {
            return obj1.x < obj2.x + obj2.width &&
                   obj1.x + obj1.width > obj2.x &&
                   obj1.y < obj2.y + obj2.height &&
                   obj1.y + obj1.height > obj2.y;
        }

        function updateHearts() {
            hearts.textContent = '';
            for (let i = 0; i < health; i++) {
                hearts.textContent += '❤️';
            }
        }

        function levelComplete() {
            gameState = 'levelEnd';
            endTime.textContent = currentTime;
            endBunnies.textContent = bunniesCollected;
            endCarrots.textContent = carrotsCollected;
            levelEnd.style.display = 'block';
        }

        function gameOver() {
            levelEnd.innerHTML = '<h2>Game Over</h2>' + 
                                 `<p>You collected ${bunniesCollected} bunnies and ${carrotsCollected} carrots!</p>` +
                                 '<button id="restart-level">Try Again</button>';
            levelEnd.style.display = 'block';
            document.getElementById('restart-level').addEventListener('click', restartLevel);
        }

        // Start the game
        initLevel();
    </script>
</body>
</html>
